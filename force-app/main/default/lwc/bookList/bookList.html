<template>
    <lightning-card title="Book List" icon-name="standard:article">
        
        <div class="slds-var-p-horizontal_medium slds-grid slds-gutters">
            <div class="slds-col">
                <lightning-input
                    label="Filter by Title"
                    name="titleFilter"
                    value={titleFilter}
                    onchange={handleFilterChange}
                    placeholder="Search titles...">
                </lightning-input>
            </div>
            <div class="slds-col">
                <lightning-input
                    label="Filter by Author"
                    name="authorFilter"
                    value={authorFilter}
                    onchange={handleFilterChange}
                    placeholder="Search authors...">
                </lightning-input>
            </div>
        </div>

        <div class="slds-text-align_right slds-var-p-around_medium">
            <lightning-button
                label="Delete Selected"
                variant="destructive"
                icon-name="utility:delete"
                onclick={handleDeleteSelectedBooks}
                disabled={isDeleteButtonDisabled}>
                </lightning-button>
        </div>

        <div class="slds-var-p-around_medium">
            <lightning-datatable
                key-field="Id"
                data={books}
                columns={columns}
                onrowaction={handleRowAction}
                onrowselection={handleRowSelection}
                >
            </lightning-datatable>
            </div>

    </lightning-card>


    <template if:true={isEditModalOpen}>
        <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close" title="Close" onclick={closeEditModal}>
                        <lightning-icon icon-name="utility:close" alternative-text="Close" size="small"></lightning-icon>
                    </button>
                    <h2 class="slds-modal__title slds-text-heading_medium">Edit Book</h2>
                </header>

                <div class="slds-modal__content slds-var-p-around_medium">
                    <lightning-record-edit-form
                        record-id={currentBookId}
                        object-api-name="Book__c"
                        onsuccess={handleEditSuccess}>
                        
                        <lightning-messages></lightning-messages>

                        <lightning-input-field field-name="Name"></lightning-input-field>
                        <lightning-input-field field-name="Book_Genre__c"></lightning-input-field>
                        
                        <lightning-input-field field-name="Author__c"></lightning-input-field>
                        
                        <div class="slds-modal__footer slds-var-m-top_medium">
                            <lightning-button 
                                label="Cancel" 
                                variant="neutral" 
                                onclick={closeEditModal}></lightning-button>
                            <lightning-button 
                                label="Save" 
                                variant="brand" 
                                type="submit"
                                class="slds-var-m-left_x-small"></lightning-button>
                        </div>
                    </lightning-record-edit-form>
                </div>
            </div>
        </section>
    </template>
</template>